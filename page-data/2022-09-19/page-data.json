{"componentChunkName":"component---src-templates-post-tsx","path":"/2022-09-19","result":{"data":{"markdownRemark":{"html":"<h1>pmdr: webpack</h1>\n<ul>\n<li>リクエスト、レスポンスの型をインターフェースとして package に切り出した\n<ul>\n<li>package の作り方をそもそもあんまり知らなかった\n<ul>\n<li>package.json どうするか</li>\n<li>tsconfig.json どうするか</li>\n<li>ビルドするのか、とか</li>\n</ul>\n</li>\n<li>TypeScript の型で悩んだ</li>\n</ul>\n</li>\n<li>サーバにリクエストを送る部分をクライアントとして package に切り出した\n<ul>\n<li>型付けは aspida がやってくれるが、バリデーションは自前でやる\n<ul>\n<li><a href=\"https://github.com/aspida/aspida\">aspida/aspida: TypeScript friendly HTTP client wrapper for the browser and node.js.</a></li>\n</ul>\n</li>\n<li>バリデーションもクライアントに含めるようにした</li>\n</ul>\n</li>\n<li>Next.js から package を import するときにトランスパイルが必要\n<ul>\n<li>webpack をいじっていたが、最終的には next-transpile-modules に落ち着いた</li>\n<li><a href=\"https://github.com/martpie/next-transpile-modules\">martpie/next-transpile-modules: Next.js plugin to transpile code from node_modules</a></li>\n<li><a href=\"https://turborepo.org/blog/you-might-not-need-typescript-project-references\">You might not need TypeScript project references | Turborepo</a>\n<ul>\n<li><code class=\"language-text\">\"types\": \"./src/index.ts\"</code> で動く</li>\n</ul>\n</li>\n<li>Storybook も動かなくなる\n<ul>\n<li>package のコードを babel-loader で読み込んでいてエラーになっていた\n<ul>\n<li>Next.js 内のコードだけ babel-loader を適用するように修正した</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>apps, packages が増えたので、lint と format と lintstaged を見直した</li>\n<li>NestJS でインターフェースの型を参照できるようにした</li>\n<li>NestJS から package を import するとエラーになる\n<ul>\n<li>webpack.config.js を NestJS に設定した\n<ul>\n<li><a href=\"https://tech-blog.s-yoshiki.com/entry/260\">NestJS アプリケーションを webpack で Bundle | 404 motivation not found</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>DTO を zod でバリデーションできるように pipe を作りたい。いくつかパッケージがあるが、どれもだいたい同じようなコード\n<ul>\n<li><a href=\"https://github.com/kbkk/abitia/tree/master/packages/zod-dto\">abitia/packages/zod-dto at master · kbkk/abitia</a></li>\n<li><a href=\"https://github.com/anatine/zod-plugins/tree/main/packages/zod-nestjs\">zod-plugins/packages/zod-nestjs at main · anatine/zod-plugins</a></li>\n<li><a href=\"https://github.com/risenforces/nestjs-zod\">risenforces/nestjs-zod: All NestJS + Zod utilities you need</a></li>\n</ul>\n</li>\n</ul>\n<p>モノレポのよくあるサンプルとかは最小すぎて、他のパッケージをインポートしたときにどう解決するのかが含まれていなくて困る。</p>","fields":{"slug":"/2022-09-19"}}},"pageContext":{"slug":"/2022-09-19","prevSlug":"/2022-09-16","nextSlug":"/2022-09-23"}},"staticQueryHashes":["63159454"]}